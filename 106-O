O(nlog^2)
O(nlog^2)
O(nlog^2)
